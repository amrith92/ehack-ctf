{# User-Statistics Twig template #}
{% set active = "stats" %}
{% extends "::base.html.twig" %}

{% block title %}
Statistics &middot; Ehack CTF
{% endblock %}

{% block extracss %}
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.css" />
<!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.ie.css" />
    <link rel="stylesheet" href="{{ asset('bundles/ctfstatistics/css/MarkerCluster.Default.ie.css') }}" />
<![endif]-->
{% stylesheets
    'bundles/ctfstatistics/css/MarkerCluster.Default.css'
    'bundles/ctfstatistics/css/MarkerCluster.css'
    'bundles/ctfstatistics/css/user-stats.css'
    filter='cssrewrite, yui_css'
    output='user-stats.css'
%}
    <link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %}
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12">
            {% for flashMessage in app.session.flashbag.get('success') %}
                <div class="alert alert-success clearfix">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{ flashMessage }}
                </div>
            {% endfor %}
            {% for flashMessage in app.session.flashbag.get('notice') %}
                <div class="alert alert-success clearfix">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{ flashMessage }}
                </div>
            {% endfor %}
            {% for flashMessage in app.session.flashbag.get('error') %}
                <div class="alert alert-success clearfix">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{ flashMessage }}
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <div id="statsSlider" class="carousel slide" data-interval="30000">
                <ol class="carousel-indicators">
                    <li data-target="#statsSlider" data-slide-to="0" class="active"></li>
                    <li data-target="#statsSlider" data-slide-to="1"></li>
                    <li data-target="#statsSlider" data-slide-to="2"></li>
                    <li data-target="#statsSlider" data-slide-to="3"></li>
                    <li data-target="#statsSlider" data-slide-to="4"></li>
                    <li data-target="#statsSlider" data-slide-to="5"></li>
                    <li data-target="#statsSlider" data-slide-to="6"></li>
                </ol>

                <!-- Carousel items -->
                <div class="carousel-inner">
                    <div class="active item">
                        <div id="users-map"></div>
                        <div class="item-block">
                            <h5>Players all over the world</h5>
                            <p>
                                Click on the circles to view people playing in that area.
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <div class="whiteout">
                            {% render url('ctf_statistics_top_twenty_players', {}) with {}, {'standalone': true} %}
                        </div>
                        <div class="item-block">
                            <h5>Top Twenty Players</h5>
                        </div>
                    </div>
                    <div class="item">
                        <div class="whiteout">
                            {% render url('ctf_statistics_bottom_twenty_players', {}) with {}, {'standalone': true} %}
                        </div>
                        <div class="item-block">
                            <h5>Bottom Twenty Players</h5>
                        </div>
                    </div>
                    <div class="item">
                        <div id="genderChart" style="height: 300px; width: 300px;"></div>
                    </div>
                    <div class="item">
                        <div class="whiteout">
                            {% render url('ctf_statistics_top_ten_teams', {}) with {}, {'standalone': true} %}
                        </div>
                        <div class="item-block">
                            <h5>Top Ten Teams</h5>
                        </div>
                    </div>
                    <div class="item">
                        <div class="whiteout">
                            {% render url('ctf_statistics_bottom_ten_teams', {}) with {}, {'standalone': true} %}
                        </div>
                        <div class="item-block">
                            <h5>Bottom Ten Teams</h5>
                        </div>
                    </div>
                    <div class="item">
                        <div class="row-fluid whiteout centered">
                            <div class="span6">
                                <h1 id="player-count">
                                </h1>
                                <h3>players</h3>
                            </div>
                            <div class="span6">
                                <h1 id="teamstats-count">
                                </h1>
                                <h3>teams</h3>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                <div id="topOrgsChart" style="height: 150px; width: 150px;"></div>
                            </div>
                            <div class="span6">
                                <div id="bottomOrgsChart" style="height: 150px; width: 150px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Carousel nav -->
                <a class="carousel-control left" href="#statsSlider" data-slide="prev">&lsaquo;</a>
                <a class="carousel-control right" href="#statsSlider" data-slide="next">&rsaquo;</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extrajsend %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
<script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
<script src="http://cdn.leafletjs.com/leaflet-0.6/leaflet.js"></script>
{% javascripts
    '@CTFCommonBundle/Resources/public/js/canvasjs.min.js'
    '@CTFStatisticsBundle/Resources/public/js/leaflet.markercluster.js'
    '@CTFStatisticsBundle/Resources/public/js/user-stats.js'
    filter='yui_js'
    output='user-stats.js'
%}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}
{% endblock %}